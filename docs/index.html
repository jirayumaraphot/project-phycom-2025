<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rhythm Game</title>

  <!-- W3.CSS Framework -->
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- Navbar -->
  <div class="w3-top">
    <div class="w3-bar w3-white w3-padding w3-card" style="letter-spacing:2px;">
      <a href="#home" class="w3-bar-item w3-button w3-wide">ðŸŽµ Rhythm Game</a>
      <div class="w3-right w3-hide-small">
        <a href="#about" class="w3-bar-item w3-button">About</a>
        <a href="#components" class="w3-bar-item w3-button">Components</a>
        <a href="#demo" class="w3-bar-item w3-button">Demo</a>
        <a href="#sourcecode" class="w3-bar-item w3-button">Source Code</a>
        <a href="#member" class="w3-bar-item w3-button">Member</a>
      </div>
    </div>
  </div>

  <!-- Home Section -->
  <header id="home" class="w3-display-container w3-center w3-black" style="height:100vh;">
    <div class="w3-display-middle">
      <h1 class="w3-xxxlarge">Welcome to <span class="w3-text-teal">Rhythm Game</span></h1>
      <p class="w3-large">Hit the notes on time. Test your reflexes. Feel the beat!</p>
      <a href="#about" class="w3-button w3-teal w3-padding-large w3-round-large">Start Exploring</a>
    </div>
  </header>

  <!-- About Section -->
  <section id="about" class="w3-container w3-padding-64">
    <h2 class="w3-center">About the Game</h2>
    <p class="w3-center w3-large">Our rhythm game combines timing and precision in a simple, fun way using Arduino technology!</p>
    <p>Players must press buttons in sync with moving notes on an LCD screen. The project demonstrates how embedded systems and creativity come together to make interactive entertainment.</p>
  </section>

  <!-- Components Section -->
  <section id="components" class="w3-container w3-light-grey w3-padding-64">
    <h2 class="w3-center">Components Used</h2>
    <div class="w3-row-padding w3-center" style="margin-top:32px;">

      <div class="w3-third">
        <img src="img/arduino_uno_r4_wifi.jpg" alt="Arduino Uno R4 WiFi"
            class="w3-image w3-round-large" style="width:120px; height:auto;">
        <h4>Arduino Uno R4 WiFi</h4>
        <p>The brain of the rhythm game, processing button inputs and controlling the display.</p>
      </div>

      <div class="w3-third">
        <img src="img/LCD_Display.jpg" alt="LCD Display"
            class="w3-image w3-round-large" style="width:120px; height:auto;">
        <h4>LCD Display</h4>
        <p>Shows the falling notes and player feedback (HIT or MISS).</p>
      </div>

      <div class="w3-third">
        <img src="img/Push_Buttons.jpg" alt="Push Buttons"
            class="w3-image w3-round-large" style="width:120px; height:auto;">
        <h4>Push Buttons</h4>
        <p>Used by players to hit notes in sync with the rhythm.</p>
      </div>

    </div>
  </section>


  <!-- Demo Section -->
  <section id="demo" class="w3-container w3-padding-64 w3-center">
    <h2>Demo</h2>
    <p>Watch our game in action below!</p>
    <div class="w3-margin-top">
      <iframe width="560" height="315" src="https://www.youtube.com/embed/your_video_id_here"
              title="Rhythm Game Demo" frameborder="0" allowfullscreen></iframe>
    </div>
  </section>

  <!-- Source Code Section -->
  <section id="sourcecode" class="w3-container w3-light-grey w3-padding-64">
    <h2 class="w3-center">Source Code (Arduino)</h2>
    <pre class="w3-code w3-border w3-round-large" style="max-height:400px; overflow-y:auto; white-space:pre;">
// Example snippet
#include <Wire.h>
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27, 16, 2);

const int buttonPins[2] = {7, 8};
const int LCD_COLS = 11;
const int LCD_ROWS = 2;

int notes[LCD_ROWS][LCD_COLS];
unsigned long lastStep = 0;
int stepInterval = 400; // ms per movement
int score = 0;

String feedbackTop = "";
String feedbackBottom = "";
unsigned long feedbackTimeTop = 0;
unsigned long feedbackTimeBottom = 0;

// Note
byte noteChar[8] = {
  B00000,
  B01110,
  B10001,
  B10001,
  B10001,
  B10001,
  B01110,
  B00000
};

// Hit zone (solid block)
byte hitZoneChar[8] = {
  B11111,
  B11111,
  B11111,
  B11111,
  B11111,
  B11111,
  B11111,
  B11111
};

// Hit effect (flash)
byte hitEffectChar[8] = {
  B00000,
  B01110,
  B11111,
  B11111,
  B11111,
  B11111,
  B01110,
  B00000
};

// GO symbol
byte goChar[8] = {
  B00000,
  B01110,
  B10001,
  B10111,
  B10001,
  B01110,
  B00000,
  B00000
};

void setup() {
  lcd.init();
  lcd.backlight();

  lcd.createChar(0, noteChar);
  lcd.createChar(1, hitZoneChar);
  lcd.createChar(2, hitEffectChar);
  lcd.createChar(3, goChar);

  for (int i = 0; i < 2; i++) pinMode(buttonPins[i], INPUT_PULLUP);

  startCountdown();
  generatePattern();
  displayNotes();
}

void loop() {
  unsigned long now = millis();

  // Move notes
  if (now - lastStep >= stepInterval) {
    lastStep = now;
    shiftNotesLeft();
    displayNotes();
  }

  // Handle button presses
  handleButtons();

  // Clear top feedback
  if (feedbackTop != "" && millis() - feedbackTimeTop > 500) {
    feedbackTop = "";
    displayNotes();
  }

  // Clear bottom feedback
  if (feedbackBottom != "" && millis() - feedbackTimeBottom > 500) {
    feedbackBottom = "";
    displayNotes();
  }

  delay(50);
}

// -------------------- FUNCTIONS --------------------

void startCountdown() {
  lcd.clear();
  lcd.setCursor(4, 0);
  lcd.print("Get Ready!");

  for (int i = 3; i >= 1; i--) {
    lcd.setCursor(7, 1);
    lcd.print(i);
    delay(700);
    lcd.setCursor(7, 1);
    lcd.print(" ");
  }

  for (int blink = 0; blink < 3; blink++) {
    lcd.clear();
    lcd.setCursor(5, 0);
    lcd.print("GO!");
    lcd.setCursor(7, 1);
    lcd.write(byte(3));
    delay(250);
    lcd.clear();
    delay(200);
  }
  lcd.clear();
}

void shiftNotesLeft() {
  for (int r = 0; r < LCD_ROWS; r++) {
    // If a note was in the hit zone and is leaving it, count as Miss
    if (notes[r][0] == 2) {
      // Missed
      if (r == 0) {
        feedbackTop = "M";
        feedbackTimeTop = millis();
      } else if (r == 1) {
        feedbackBottom = "M";
        feedbackTimeBottom = millis();
      }
      notes[r][0] = 0; // clear hit zone
    }

    // Move note from column 1 into hit zone
    if (notes[r][1] == 1) {
      notes[r][0] = 2; // note entering hit zone (flash)
    }

    // Shift all other notes left (excluding hit zone)
    for (int c = 1; c < LCD_COLS - 1; c++) {
      notes[r][c] = notes[r][c + 1];
    }

    // Spawn new note at far right randomly
    notes[r][LCD_COLS - 1] = (random(0, 10) < 3) ? 1 : 0;
  }
}

void displayNotes() {
  lcd.clear();

  for (int r = 0; r < LCD_ROWS; r++) {
    for (int c = 0; c < LCD_COLS; c++) {
      lcd.setCursor(c, r);

      if (c == 0) { // Hit zone column
        if (notes[r][0] == 2)
          lcd.write(byte(2)); // flash effect
        else
          lcd.write(byte(1)); // solid hit zone
      } else if (notes[r][c] == 1) {
        lcd.write(byte(0));   // moving note
      } else {
        lcd.print(" ");       // empty space
      }
    }
  }

  // Score display on top-right
  lcd.setCursor(11, 0);
  lcd.print("S:");
  lcd.print(score);
  lcd.print("  ");

  // Feedback display on bottom-right
  if (feedbackTop != "") {
    lcd.setCursor(12, 1);
    lcd.print(feedbackTop);
  }
  if (feedbackBottom != "") {
    lcd.setCursor(14, 1);
    lcd.print(feedbackBottom);
  }
}

void generatePattern() {
  randomSeed(analogRead(A0));
  for (int r = 0; r < LCD_ROWS; r++) {
    for (int c = 0; c < LCD_COLS; c++) {
      notes[r][c] = (random(0, 10) < 3) ? 1 : 0;
    }
  }
}

void handleButtons() {
  bool button0 = (digitalRead(buttonPins[0]) == LOW); // top
  bool button1 = (digitalRead(buttonPins[1]) == LOW); // bottom
  int scoreIncrement = 0;

  // -------- TOP ROW --------
  if (button0) {
    if (notes[0][0] == 1 || notes[0][0] == 2) { // Perfect
      scoreIncrement++;
      notes[0][0] = 0;
      feedbackTop = "P";
      feedbackTimeTop = millis();
    } else if (notes[0][1] == 1) {              // Good
      feedbackTop = "G";
      feedbackTimeTop = millis();
    } else {                                    // Miss
      feedbackTop = "M";
      feedbackTimeTop = millis();
    }
  }

  // -------- BOTTOM ROW --------
  if (button1) {
    if (notes[1][0] == 1 || notes[1][0] == 2) { // Perfect
      scoreIncrement++;
      notes[1][0] = 0;
      feedbackBottom = "P";
      feedbackTimeBottom = millis();
    } else if (notes[1][1] == 1) {              // Good
      feedbackBottom = "G";
      feedbackTimeBottom = millis();
    } else {                                    // Miss
      feedbackBottom = "M";
      feedbackTimeBottom = millis();
    }
  }

  // Update global score
  score += scoreIncrement;

  // Refresh display
  if (button0 || button1) displayNotes();
}
    </pre>
  </section>

  <!-- Member Section -->
  <section id="member" class="w3-container w3-padding-64 w3-center">
    <h2>Project Members</h2>
    <div class="w3-row-padding" style="margin-top:32px;">
      <div class="w3-third">
        <div class="w3-card w3-padding w3-round-large">
          <h4>Member 1</h4>
          <p>Game Logic & Arduino Code</p>
        </div>
      </div>
      <div class="w3-third">
        <div class="w3-card w3-padding w3-round-large">
          <h4>Member 2</h4>
          <p>LCD Display & UI Design</p>
        </div>
      </div>
      <div class="w3-third">
        <div class="w3-card w3-padding w3-round-large">
          <h4>Member 3</h4>
          <p>Documentation & Testing</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="w3-center w3-black w3-padding-32">
    <p>Â© 2025 Rhythm Game Project</p>
  </footer>

</body>
</html>
